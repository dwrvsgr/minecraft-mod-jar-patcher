# minecraft-mod-jar-patcher

这是一款轻量级的 Minecraft 模组修改器，专为**习惯直接修改 `.jar` 文件的 MC 玩家**设计。它采用直接修改 JAR 包内部文件的方式实现模组修改功能。

目前支持的模组包括**等价交换（Project E）**和**沉浸式飞机（Immersive Aircraft）**，覆盖 Minecraft 1.12.2 至 1.21.1 的多个版本。

## 使用方法

可通过 `python run.py -h` 查看完整参数说明：

```python
usage: Minecraft Mod Patcher [-h] [--jar_path str]
                             [--output_dir {str,null}] [--mod_name str]
                             [--validate_jar bool]

options:
  -h, --help            显示帮助信息
  --jar_path str        MOD 文件路径
  --output_dir {str,null}
                        修改后的 MOD 文件输出目录，留空则覆盖原文件
  --mod_name str        模组名称（目前支持：projecte、immersive_aircraft）
  --validate_jar bool   修改前是否进行原始文件校验（确保 MOD 来源为 CurseForge/Modrinth）
                        (default: True)
```


### 使用示例

以等价交换模组为例：

```shell
python run.py \
  --jar_path ~/Downloads/ProjectE-1.20.1-PE1.0.1.jar \
  --output_dir ~/Desktop \
  --mod_name projecte
```

### 工作流程

修改器按照以下步骤执行：

1. **解压 JAR 文件**：将 `ProjectE-1.20.1-PE1.0.1.jar` 解压到临时缓存目录（位于 `~/.cache/`）
2. **执行修改操作**：进入解压后的目录，按照预定义的规则修改模组文件
3. **重新打包输出**：将修改后的文件重新打包为 JAR，输出到指定目录，并自动清理临时缓存



### 查看修改规则

若想查看某个模组的具体修改规则，可进入 `mods/<mod_name>/<mod_name>_<version>.py` 查看实现代码。目前的修改规则均基于作者的游玩体验进行定制，你可以根据自己的需求进行调整或重写。

---

## 新增模组修改

如果你想为新的模组添加修改规则，请按照以下步骤进行：

1. **创建模组目录**：在 `mods/` 下创建名为 `<modid>` 的目录，并在该目录下创建 `<modid>_<version>.py` 文件实现具体的修改逻辑。如果修改逻辑需要其他辅助文件（如纹理、配置等），也请统一放在该目录下。

2. **更新导入配置**：修改 `mods/__init__.py`，按照现有格式添加新的 Patcher 类导入。

3. **注册模组元数据**：修改 `meta.py`，按照现有格式添加 JAR 文件名、MD5 校验值和对应的 Patcher 类。

---

## out 目录

`out` 目录存放已修改完成的模组 JAR 文件，可直接下载使用。



## 已实现的模组修改

### 等价交换（Project E）

**支持版本**：Minecraft 1.12.2 / 1.16.5 / 1.18.2 / 1.19.2 / 1.20.1 / 1.21.1  
**注意**：暂不支持 1.12 以下的版本，因为这些版本不支持 JSON 格式的合成配方。

#### 修改背景

众所周知，**等价交换（Project E）**模组在游戏前期允许玩家通过**与村民交易获取绿宝石**来快速积累 EMC；到了中后期，玩家则主要依赖**能量收集器（Energy Collector）**实现大规模刷取。一旦获得**暗物质/红物质/宝石套装**，并配合**飞行、抗火、无限氧气、水上行走、自动恢复**等功能性饰品，角色的能力将基本等同于**创造模式**。这些机制和物品极大地**破坏了游戏的平衡性**，因此有必要对其进行**魔改**。

#### 主要调整内容

- **调整绿宝石的 EMC 值为 160**  
  这一数值是基于对村民 **13 种职业的全部单向交易（买入）** 进行调研后计算得出的。通过此调整，**约只有 20% 的村民单向交易（买入）能让玩家获利**，从而有效限制了前期的 EMC 积累速度。

- **仅保留转化桌和便携式转化桌**  
  对它们的合成配方进行了修改，**删除了除此之外所有其他等价交换物品的合成配方**。在非作弊模式下，玩家将无法获取其他等价交换物品。

- **为部分原版物品赋予 EMC 值**  
  为原版中一些没有 EMC 值的物品赋予了合理的 EMC 值，这些数值基于 GPT-Thinking 推理确定。

- **支持农夫乐事模组**  
  为**农夫乐事（Farmer's Delight）**模组中的所有物品赋予了 EMC 值。

- **重命名核心物品**  
  将转化桌和便携式转化桌的名称修改为**交易台和交易终端**，并同步修改了对应的**物品材质和 GUI 界面**。

- **更改主题为交易向**  
  将 EMC 替换为 Coins（硬币），并修改了相关文本，使模组更符合交易向的设定。



#### 补充说明

- 作者本想直接将绿宝石的 EMC 值设定为 0（即清空绿宝石的 EMC），但发现这种做法会导致所有物品失去 EMC 值。如需此功能，建议在 `config/projecte/custom_emc.json` 中进行配置。
- 目前绿宝石的 EMC 值设定仅考虑了买入交易，未考虑卖出交易，因此尚不明确该数值将带来哪些具体影响。

---

### 沉浸式飞机（Immersive Aircraft）

**支持版本**：Minecraft 1.20.1

#### 修改背景

沉浸式飞机是一款优秀且轻量化的飞机模组，被广泛收录于各类整合包中。然而，既然是飞机，其制造成本理应不低。当前版本中，**无论是发动机还是其他关键部件，所需原料都过于基础**，玩家在游戏早期即可轻松获取并制造飞机，这与现实逻辑不符。此外，在采用世界地图的服务器中，若玩家能在前期便造出飞机，便可轻易飞往任意国家，破坏了服务器的进程与探索节奏。**我们希望玩家在中后期阶段，经过一定的发展与积累，才逐步具备制造与驾驶飞机的能力**。基于此，我们适当提升了飞机的制造成本，以更合理地体现其科技与资源价值。

#### 基础部件调整

| 部件             | 原材料调整                     | 新增材料 |
| ---------------- | ------------------------------ | -------- |
| **机身**         | 铁锭 → 铁块                    | —        |
| **发动机**       | 圆石 → 铁块                    | —        |
| **风帆**         | 线 → 拴绳、白色地毯 → 任意地毯 | —        |
| **螺旋桨**       | 铁锭 → 铁块                    | —        |
| **锅炉**         | 铜锭 → 铜块                    | + 水桶   |
| **增强型螺旋桨** | 铜锭 → 铜块                    | —        |
| **钢制锅炉**     | 铁锭 → 铁块                    | —        |
| **工业齿轮**     | 铁锭 → 铁块、铜锭 → 铜块       | —        |
| **加固管道**     | 铁锭 → 铁块、铜锭 → 铜块       | —        |
| **机身加固板**   | 铁锭 → 铁块                    | —        |
| **改良起落架**   | 铁锭 → 铁块                    | —        |

#### 高级发动机调整

**经济型发动机**

| 红砖块 | 金块 | 红砖块 |
| :---: | :---: | :---: |
| 黏性活塞 | 发动机 | 黏性活塞 |
| 金块 | 红砖块 | 金块 |

**下界发动机**

| 岩浆块 | 下界合金块 | 岩浆块 |
| :---: | :---: | :---: |
| 烈焰棒 | 发动机 | 烈焰棒 |
| 下界合金块 | 恶魂之泪 | 下界合金块 |

